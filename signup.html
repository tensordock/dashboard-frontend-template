<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signup to GPUfleet</title>
    <script src="./static/js/config.js"></script>
    <script src="./static/js/simplebar.min.js"></script>
    <link rel="stylesheet" href="./static/css/swiper.css" />
    <link
      rel="preconnect" href="https://fonts.gstatic.com">
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700%7cPoppins:300,400,500,600,700,800,900&amp;display=swap"
      rel="stylesheet">
    <link rel="stylesheet" href="static/css/theme.bundle.css" />
    <link rel="stylesheet" href="./static/css/custom.css" />
    <script>
      // If the user is already logged in, redirect
      const baseUrl = 'https://marketplace.tensordock.com';

      const whitelabelToken = document.cookie.split('; ').find(row => row.startsWith('whitelabelToken='));
      document.addEventListener("DOMContentLoaded", async () => {
      let loggedIn = false;
      const userInfo = { email: '', orgName: '' };

      if (whitelabelToken) {
          const response = await fetch(`${baseUrl}/api/v0/client/whitelabel/token_verify`, {
              method: 'POST',
              headers: {
              'Content-Type': 'application/json',
              'Authorization': whitelabelToken.split('=')[1]
              },
          });
          if (response.ok) {
              const tokenVerifyResponse = await response.json();
              loggedIn = true;
              userInfo.email = tokenVerifyResponse.email;
              userInfo.orgName = tokenVerifyResponse.org_name;
              window.location = '/list';
          } 
      }
      })

      function submitForm() {
        document.getElementById("signup-button").disabled = true;

        let formData = new FormData();

        formData.append('email', document.getElementById('email').value);
        formData.append('password', document.getElementById('password').value);
        formData.append('confirm_password', document.getElementById('confirm_password').value);
        formData.append('organization_name', document.getElementById('organization_name').value);
        formData.append('subdomain', window.location.hostname);

        fetch(`${baseUrl}/api/v0/client/whitelabel/register`, {
          method: 'POST',
          body: formData
        })
        .then((response) => response.json())
        .then((data) => {
          document.cookie = `whitelabelToken=${data.token}`;
          window.location.href = '/account';
        })
        .catch(error => console.error('Error:', error));
      }
  </script>
  </head>
  <body>
    <main class="main" id="top">
      <nav class="navbar navbar-standard navbar-expand-lg fixed-top navbar-dark"
           data-navbar-darken-on-scroll="data-navbar-darken-on-scroll">
        <div class="container"><a class="navbar-brand"
                                  href="/"><span
                class="text-white dark__text-white">GPUfleet</span></a>
          <button class="navbar-toggler collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#navbarStandard"
                  aria-controls="navbarStandard" aria-expanded="false"
                  aria-label="Toggle navigation"><span
                  class="navbar-toggler-icon"></span></button>
          <div class="collapse navbar-collapse scrollbar" id="navbarStandard">
            <ul class="navbar-nav"
                data-top-nav-dropdowns="data-top-nav-dropdowns">
              <li class="nav-item dropdown"><a class="nav-link" href="/deploy">Deploy</a>
              </li>
              <li class="nav-item dropdown"><a class="nav-link" href="#" role="button">Documentation</a></li>
            </ul>
            <ul class="navbar-nav ms-auto">
              <li class="nav-item d-flex align-items-center me-2">
                <div class="dropdown theme-control-dropdown landing-drop"><a
                        class="nav-link d-flex align-items-center dropdown-toggle fa-icon-wait pe-1"
                        href="#" role="button" id="themeSwitchDropdown"
                        data-bs-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="false"><span class="d-none d-lg-block"><span
                        class="fas fa-sun"
                        data-theme-dropdown-toggle-icon="light"></span><span
                        class="fas fa-moon"
                        data-theme-dropdown-toggle-icon="dark"></span><span
                        class="fas fa-adjust"
                        data-theme-dropdown-toggle-icon="auto"></span></span><span
                        class="d-lg-none">Switch theme</span></a>
                  <div
                          class="dropdown-menu dropdown-menu-end dropdown-caret border py-0 mt-1"
                          aria-labelledby="themeSwitchDropdown">
                    <div class="bg-white dark__bg-1000 rounded-2 py-2">
                      <button
                              class="dropdown-item link-600 d-flex align-items-center gap-2"
                              type="button" value="light"
                              data-theme-control="theme"><span
                              class="fas fa-sun"></span>Light<span
                              class="fas fa-check dropdown-check-icon ms-auto text-600"></span></button>
                      <button
                              class="dropdown-item link-600 d-flex align-items-center gap-2"
                              type="button" value="dark"
                              data-theme-control="theme"><span class="fas fa-moon"
                                                               data-fa-transform></span>Dark<span
                              class="fas fa-check dropdown-check-icon ms-auto text-600"></span></button>
                      <button
                              class="dropdown-item link-600 d-flex align-items-center gap-2"
                              type="button" value="auto"
                              data-theme-control="theme"><span class="fas fa-adjust"
                                                               data-fa-transform></span>Auto<span
                              class="fas fa-check dropdown-check-icon ms-auto text-600"></span></button>
                    </div>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <div class="container-fluid">
        <div class="row min-vh-100 bg-100">
          <div class="col-6 d-none d-lg-block position-relative">
            <!-- Start Background; to change the photo, upload a photo and then replace it here: -->
            <div class="bg-holder"
              style="background-image:url(https://gpufleet.consoledock.com/static/img/bg.jpeg);background-position: 50% 20%;">
            </div>
            <!-- End Background -->
          </div>
          <div
            class="col-sm-10 col-md-6 px-sm-0 align-self-center mx-auto py-5">
            <div class="row justify-content-center g-0">
              <div class="col-lg-9 col-xl-8 col-xxl-6">
                <div class="card">
                  <div
                    class="card-header bg-circle-shape bg-shape text-center p-2"><a
                      class="font-sans-serif fw-bolder fs-5 z-1 position-relative link-light"
                      href="/index.html"
                      data-bs-theme="light">GPUfleet</a></div>
                  <div class="card-body p-4">
                    <div class="row flex-between-center">
                      <div class="col-auto">
                        <h3>Sign Up</h3>
                      </div>
                      <div class="col-auto fs-10 text-600"><span
                          class="mb-0 fw-semi-bold">Existing User?</span>
                        <span><a
                            href="/login">Log In</a></span></div>
                    </div>
                    <form>
                      <div class="mb-3">
                        <label class="form-label" for="email">Email
                          address</label>
                        <input class="form-control" id="email"
                          type="email">
                      </div>
                      <div class="mb-3">
                        <div class="d-flex justify-content-between">
                          <label class="form-label"
                            for="password">Password</label>
                        </div>
                        <input class="form-control" id="password"
                          type="password">
                      </div>
                      <div class="mb-3">
                        <div class="d-flex justify-content-between">
                          <label class="form-label"
                            for="password">Confirm Password</label>
                        </div>
                        <input class="form-control" id="confirm_password"
                          type="password">
                      </div>
                      <div class="mb-3">
                        <div class="d-flex justify-content-between">
                          <label class="form-label"
                            for="password">Company / Organization</label>
                        </div>
                        <input class="form-control" id="organization_name"
                          type="organization_name">
                      </div>
                      <div class="mb-3">
                        <button
                          id="signup-button"
                          class="btn btn-primary d-block w-100 mt-3"
                          type="button"
                          onclick="submitForm()"
                        >
                          Sign Up
                        </button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <script src="./static/js/popper.min.js"></script>
    <script src="./static/js/bootstrap.min.js"></script>
    <script src="./static/js/anchor.min.js"></script>
    <script src="./static/js/is.min.js"></script>
    <script src="./static/js/swiper-bundle.min.js"></script>
    <script src="./static/js/typed.js"></script>
    <script src="./static/js/fa.min.js"></script>
    <script src="./static/js/lodash.min.js"></script>
    <script src="./static/js/list.min.js"></script>
    <script src="./static/js/theme.js"></script>
  </body>
</html>